<html style='height:100%'>
<head>
    <title>Erachain Crypto Lib</title>
    <script type="text/javascript" src="js/erachainapi.js"></script>
    <script>
        
        const url = "http://192.168.1.86:9067/api";

        const request = new EraChain.Fetch(url)

        console.log(request);

        async function onLoad() {

            //2RSehSu6szKbhEap46fhLN4s2BCfD1N2PLqbKnVWCbPvzF9JRBJs8sbQFqqaGLs4x4TZZV8hD5irs2RiT7gsGVjq
            //3jPhyhgqry3J95PHRLmH27UhKvn93y3x6Z748uv2vKoH
            //7K8eqCRon1NKxnWn9o7dfbkTkL9zNEKCzR

            const recipientPublicKey = "3jPhyhgqry3J95PHRLmH27UhKvn93y3x6Z748uv2vKoH";
            const publicKey = await EraChain.Base58.decode(recipientPublicKey);

            const recipient = { 
                address: await EraChain.Crypt.addressByPublicKey(publicKey),
                publicKey: publicKey
            };    

            console.log(recipient);
            //3jPhyhgqry3J95PHRLmH27UhKvn93y3x6Z748uv2vKoH
            //7J2iZEMkS1ykbQPRux7tYkpG788rD7FYBr

            //6jt933MGNLo8DFEtJX1HXsfu38h21PyWpBRstaNM1Q5q
            //7MNeky11DNA3nCrDEbmudZeTwsEFgeAEjS

            const tranBody = {
                head: "Test header",
                message: "Message from JS API",
                encrypted: true
            }

            const port = 9066;  

            const keys1 = {
                secretKey: await EraChain.Base58.decode("kiAeqbBDqQ4Qa5X1hdpuWnzmX3GW3i9Bwk81VmNeFkXWhypZnxCYGnPDdTbbBFkgZHQkADowQhatRqYAT72nYrf"),
                publicKey: await EraChain.Base58.decode("6jt933MGNLo8DFEtJX1HXsfu38h21PyWpBRstaNM1Q5q")
            };

            const keyPair = new EraChain.Crypt.KeyPair(keys1);

            const tran = await EraChain.Tran.tranMessage(recipient, keyPair, tranBody, port);
            console.log(tran);

            if (!tran.error) {
                const data = await request.broadcast.broadcastPost(tran.raw);
                console.log("broadcastPost", data);
            }
            
        }

    </script>

</head>

<body onload="onLoad()">
    <div>Generate key pair:</div>
    <br/>
    <div id="secret"></div>
    <div id="public"></div>
    <br/>
    <div>Get address by public key:</div>
    <br/>
    <div id="addressByPublic"></div>
    <br/>
    <div>Get address by private key:</div>
    <br/>
    <div id="addressBySecret"></div>
    <br/>
    <div>Get public key by private key:</div>
    <br/>
    <div id="publicBySecret"></div>
    <br/>
    <div>Encrypt:</div>
    <br/>
    <div id="message"></div>
    <br/>
    <div>Decrypt:</div>
    <br/>
    <div id="decrypted"></div>
    <br/>
    <div>Generate signature:</div>
    <br/>
    <div id="signature"></div>
    <br/>
    <div>Verify signature:</div>
    <br/>
    <div id="verifySignature"></div>
    
</body>
